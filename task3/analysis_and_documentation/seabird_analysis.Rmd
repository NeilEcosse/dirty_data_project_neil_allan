---
title: "Dirty data project - task 3 analysis"
output:
  html_document:
    df_print: paged
---


```{r}
library(readxl)
library(tidyverse)
library(dplyr)
library(here)
```

#1 -  Import bird and ship data files created by **clean_data_seabirds.R**
```{r}

bird_data_by_record_id_clean <-
read_csv(here("clean_data/bird_data_by_record_id_clean.csv"))

ship_data_by_record_id_clean <-
read_csv(here("clean_data/ship_data_by_record_id_clean.csv"))
```



#2 - Analysis questions set by CodeClan

##2.1 - Which bird had the most individual sightings?
```{r}
bird_data_by_record_id_clean %>%
group_by(species_common_name, 
         species_scientific_name,
         species_abbreviation) %>% 
summarise(total_sightings = n()) %>% 
arrange(desc(total_sightings)) %>% 
head(1)
```


##2.2 - Which bird had the highest total count?
```{r}
bird_data_by_record_id_clean %>%
group_by(species_common_name, 
         species_scientific_name,
         species_abbreviation) %>% 
summarise(total_count = sum(count)) %>% 
arrange(desc(total_count)) %>% 
head(1)

```

##2.3 - Which bird had the highest total count above a latitude of -30?
```{r}
bird_data_by_record_id_clean %>%
  left_join(ship_data_by_record_id_clean, by = "record_id") %>% 
  filter(lat > -30) %>% 
  group_by(species_common_name, 
         species_scientific_name,
         species_abbreviation) %>% 
  summarise(total_count = sum(count)) %>% 
  arrange(desc(total_count)) %>% 
  head(1)
  
```

##2.4 - How many different types of birds were only ever seen in groups of 1
```{r}
bird_data_by_record_id_clean %>% 
group_by(species_common_name, 
         species_scientific_name,
         species_abbreviation) %>%  
summarise(max_count = max(count)) %>% 
arrange(max_count) %>% 
filter(max_count == 1)
```


##2.5 - How many penguins were seen? (Hint: there are many types of penguin)
```{r}
bird_data_by_record_id_clean %>%
filter(str_detect(species_common_name, "[pP]enguin")) %>% 
#group_by(species_common_name, 
#         species_scientific_name,
#         species_abbreviation) %>% 
summarise(total_number_penguins = sum(count)) #%>% 
#arrange(desc(total_number_penguins)) 
```

